<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta application-name="Stocks" data-allows-resizig="YES" data-default-size="4,4" data-min-size="4,4" data-max-size="8,8" data-allows-scrolling="NO" />
    <title>StockStatus</title>
    <link href='http://fonts.googleapis.com/css?family=Homenaje' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/stockstatus/css/reset.css">
    <link rel="stylesheet" href="/stockstatus/css/stockstatus.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="/stockstatus/js/jquery.mustache.js"></script>
    <script src="/stockstatus/js/stockstatus.js"></script>
    <script type="text/javascript">
      $(document).on('ready', function() {
      console.log(window.location);
        var path = window.location.pathname, symbols;
        path = path.replace('/stockstatus','');

        if (path.indexOf('?') < 0)
          symbols = ['TWTR','AAPL'];
        else
          symbols = path.substring(path.indexOf('?')+1).split('+');

console.log(symbols);
        var ss = new StockStatus(symbols);
        ss.updateView();

        $('body').on('dblclick', function(e) {
          e.preventDefault();
          ss.updateView();
        });

        $('#view').on('click', 'tr.row', function(e) {
          e.preventDefault();
          $(e.target).closest('tr').next().toggleClass('hidden');
        });

        setInterval(function(){
          ss.updateView();
        }, 60000);
      });
    </script>
  </head>
  <body>
    <div class="container">
      <table id="view">
      </table>
    </div>
  </body>
  <script id="template" type="x-tmpl-mustache">
    <tr id="{{symbol}}-{{index}}" class="row">
      <td>{{symbol}}</td>
      <td>{{quote}}</td>
      <td class="last"><span class="pill {{changeColor}}">{{change}}</span></td>
    </tr>
    <tr id="{{symbol}}-{{index}}-detail" class="detail hidden">
      <td colspan="3">
        <dl>
          <dt>High:</dt>
          <dd>{{daysHigh}}</dd>
        </dl>
        <dl>
          <dt>Low:</dt>
          <dd>{{daysLow}}</dd>
        </dl>
      </td>
    </tr>
  </script>
</html>
